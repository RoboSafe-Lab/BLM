2025-08-07 11:02:13,430 INFO    MainThread:8237 [wandb_setup.py:_flush():80] Current SDK version is 0.21.0
2025-08-07 11:02:13,430 INFO    MainThread:8237 [wandb_setup.py:_flush():80] Configure stats pid to 8237
2025-08-07 11:02:13,430 INFO    MainThread:8237 [wandb_setup.py:_flush():80] Loading settings from /home/visier/.config/wandb/settings
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_setup.py:_flush():80] Loading settings from /home/visier/safety-critical/wandb/settings
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_setup.py:_flush():80] Loading settings from environment variables
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_init.py:setup_run_log_directory():703] Logging user logs to ./wandb/run-20250807_110213-pd1y261q/logs/debug.log
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to ./wandb/run-20250807_110213-pd1y261q/logs/debug-internal.log
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_init.py:init():830] calling init triggers
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_init.py:init():835] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-08-07 11:02:13,431 INFO    MainThread:8237 [wandb_init.py:init():871] starting backend
2025-08-07 11:02:13,648 INFO    MainThread:8237 [wandb_init.py:init():874] sending inform_init request
2025-08-07 11:02:13,651 INFO    MainThread:8237 [wandb_init.py:init():882] backend started and connected
2025-08-07 11:02:13,653 INFO    MainThread:8237 [wandb_init.py:init():953] updated telemetry
2025-08-07 11:02:13,653 INFO    MainThread:8237 [wandb_init.py:init():977] communicating run to backend with 90.0 second timeout
2025-08-07 11:02:14,431 INFO    MainThread:8237 [wandb_init.py:init():1029] starting run threads in backend
2025-08-07 11:02:14,637 INFO    MainThread:8237 [wandb_run.py:_console_start():2458] atexit reg
2025-08-07 11:02:14,637 INFO    MainThread:8237 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-08-07 11:02:14,638 INFO    MainThread:8237 [wandb_run.py:_redirect():2375] Wrapping output streams.
2025-08-07 11:02:14,638 INFO    MainThread:8237 [wandb_run.py:_redirect():2398] Redirects installed.
2025-08-07 11:02:14,640 INFO    MainThread:8237 [wandb_init.py:init():1075] run started, returning control to user process
2025-08-07 11:02:14,643 INFO    MainThread:8237 [wandb_run.py:_config_callback():1363] config_cb None None {'registered_name': 'safety_critical', 'train': {'logging': {'terminal_output_to_txt': True, 'log_tb': False, 'log_wandb': True, 'wandb_project_name': 'SC_GMM_Diffuser', 'log_every_n_steps': 10, 'flush_every_n_steps': 100}, 'save': {'enabled': True, 'every_n_steps': 1000, 'best_k': 1, 'save_best_rollout': False, 'save_best_validation': True}, 'rollout': {'save_video': True, 'enabled': False, 'every_n_steps': 10000, 'warm_start_n_steps': 0}, 'training': {'batch_size': 64, 'num_steps': 5000, 'num_data_workers': 16}, 'validation': {'enabled': True, 'batch_size': 32, 'num_data_workers': 16, 'every_n_steps': 500, 'num_steps_per_epoch': 5}, 'parallel_strategy': None, 'on_ngc': False, 'datamodule_class': 'CLDDataModule', 'trajdata_cache_location': '/home/visier/cld_cache', 'trajdata_source_train': ['nusc_mini-mini_train'], 'trajdata_source_valid': ['nusc_mini-mini_val'], 'trajdata_data_dirs': {'nusc_trainval': '/home/visier/nuscenes', 'nusc_test': '/home/visier/nuscenes', 'nusc_mini': '/home/visier/nuscenes'}, 'trajdata_rebuild_cache': False, 'training_vec_map_params': {'S_seg': 15, 'S_point': 80, 'map_max_dist': 80, 'max_heading_error': 0.7853981633974483, 'ahead_threshold': -40, 'dist_weight': 1.0, 'heading_weight': 0.1}, 'rebuild_cache': 'false'}, 'env': {'name': 'trajdata', 'data_generation_params': {'trajdata_centric': 'agent', 'trajdata_only_types': ['vehicle'], 'trajdata_predict_types': ['vehicle'], 'trajdata_scene_desc_contains': None, 'trajdata_incl_map': True, 'trajdata_max_agents_distance': 50, 'trajdata_standardize_data': True, 'other_agents_num': None, 'incl_robot_future': True}, 'rasterizer': {'include_hist': True, 'num_sem_layers': 3, 'drivable_layers': None, 'rgb_idx_groups': [[0], [1], [2]], 'raster_size': 224, 'pixel_size': 1.0, 'ego_center': [-0.5, 0.0], 'no_map_fill_value': -1.0}}, 'algo': {'name': 'diffuser_ppo', 'scene_agent_max_neighbor_dist': 30, 'map_encoder_model_arch': 'resnet18', 'map_feature_dim': 128, 'map_grid_feature_dim': 32, 'history_num_frames': 30, 'history_feature_dim': 64, 'state_in_dim': 4, 'state_out_feat_dim': 64, 'cond_feat_dim': 128, 'time_emb_dim': 32, 'attn_hidden_dim': 64, 'attn_dilations': [1, 2, 4], 'attn_n_heads': 4, 'grid_map_traj_dim': 32, 'mix_gauss': 5, 'horizon': 52, 'n_diffusion_steps': 100, 'ddim_steps': 20, 'future_num_frames': 52, 'step_time': 0.1, 'dynamics': {'type': 'Unicycle', 'max_steer': 0.5, 'max_yawvel': 2.5, 'acce_bound': [-3, 3], 'ddh_bound': [-6.283185307179586, 6.283185307179586], 'max_speed': 40.0}, 'optim_params': {'learning_rate': {'initial': 0.0002, 'weight_decay': 0.0001}}, 'norm_info': {'diffuser': [[2.135494, 0.003704, 0.970226, 0.000573, -0.002965, 0.000309], [5.5444, 0.524067, 2.206522, 0.049049, 0.729327, 0.023765]], 'agent_hist': [[-1.198923, 0.000128, 0.953161, 4.698113, 2.051664], [3.180241, 0.159182, 2.129779, 2.116855, 0.388149]], 'neighbor_hist': [[-0.237441, 1.118636, 0.489575, 0.868664, 0.222984], [7.587311, 7.444489, 1.680952, 2.578202, 0.832563]]}}, 'eval': {'name': None, 'env': 'nusc', 'dataset_path': None, 'eval_class': '', 'seed': 0, 'num_scenes_per_batch': 1, 'num_scenes_to_evaluate': 1, 'num_episode_repeats': 1, 'start_frame_index_each_episode': None, 'seed_each_episode': None, 'ego_only': False, 'agent_eval_class': None, 'ckpt_root_dir': 'checkpoints/', 'experience_hdf5_path': None, 'results_dir': 'results/', 'ckpt': {'policy': {'ngc_job_id': None, 'ckpt_dir': None, 'ckpt_key': None}, 'planner': {'ngc_job_id': None, 'ckpt_dir': None, 'ckpt_key': None}, 'predictor': {'ngc_job_id': None, 'ckpt_dir': None, 'ckpt_key': None}, 'cvae_metric': {'ngc_job_id': None, 'ckpt_dir': None, 'ckpt_key': None}, 'occupancy_metric': {'ngc_job_id': None, 'ckpt_dir': None, 'ckpt_key': None}}, 'policy': {'mask_drivable': True, 'num_plan_samples': 50, 'num_action_samples': 2, 'pos_to_yaw': True, 'yaw_correction_speed': 1.0, 'diversification_clearance': None, 'sample': False, 'cost_weights': {'collision_weight': 10.0, 'lane_weight': 1.0, 'likelihood_weight': 0.0, 'progress_weight': 0.0}, 'use_ema': False, 'class_free_guide_w': 0.0, 'guide_as_filter_only': False, 'guide_clean': 'video_diff'}, 'goal_conditional': False, 'perturb_output_trajectory': False, 'perturb_opt_params': {'optimizer': 'adam', 'grad_steps': 30, 'perturb_th': 100.0, 'optimizer_params': {'lr': 0.001}}, 'filtration': False, 'num_filtration_samples': 5, 'guidance_optimization_params': {'optimizer': 'adam', 'lr': 0.3, 'grad_steps': 1, 'perturb_th': None}, 'denoising_params': {'stride': 1, 'perturb_output_trajectory': False}, 'metrics': {'compute_analytical_metrics': True, 'compute_learned_metrics': False}, 'perturb': {'enabled': False, 'OU': {'theta': 0.8, 'sigma': [0.0, 0.1, 0.2, 0.5, 1.0, 2.0, 4.0], 'scale': [1.0, 1.0, 0.2]}}, 'rolling_perturb': {'enabled': False, 'OU': {'theta': 0.8, 'sigma': 0.5, 'scale': [1.0, 1.0, 0.2]}}, 'occupancy': {'rolling': True, 'rolling_horizon': [5, 10, 20]}, 'cvae': {'rolling': True, 'rolling_horizon': [5, 10, 20]}, 'nusc': {'trajdata_source_test': ['nusc_trainval-val'], 'trajdata_data_dirs': {'nusc_trainval': '../behavior-generation-dataset/nuscenes'}, 'future_sec': 5.2, 'history_sec': 3.0, 'eval_scenes': [30], 'n_step_action': 5, 'num_simulation_steps': 200, 'skip_first_n': 0}, 'l5kit': {'eval_scenes': [9058, 5232, 14153, 8173, 10314, 7027, 9812, 1090, 9453, 978, 10263, 874, 5563, 9613, 261, 2826, 2175, 9977, 6423, 1069, 1836, 8198, 5034, 6016, 2525, 927, 3634, 11806, 4911, 6192, 11641, 461, 142, 15493, 4919, 8494, 14572, 2402, 308, 1952, 13287, 15614, 6529, 12, 11543, 4558, 489, 6876, 15279, 6095, 5877, 8928, 10599, 16150, 11296, 9382, 13352, 1794, 16122, 12429, 15321, 8614, 12447, 4502, 13235, 2919, 15893, 12960, 7043, 9278, 952, 4699, 768, 13146, 8827, 16212, 10777, 15885, 11319, 9417, 14092, 14873, 6740, 11847, 15331, 15639, 11361, 14784, 13448, 10124, 4872, 3567, 5543, 2214, 7624, 10193, 7297, 1308, 3951, 14001], 'n_step_action': 5, 'num_simulation_steps': 200, 'skip_first_n': 1, 'skimp_rollout': False}, 'adjustment': {'random_init_plan': False, 'remove_existing_neighbors': False, 'initial_num_neighbors': 4, 'num_frame_per_new_agent': 20}, 'trajdata': {'trajdata_cache_location': '~/.unified_data_cache', 'trajdata_rebuild_cache': False}}, 'name': 'test', 'root_dir': 'safety_critical_trained_models/', 'seed': 42, 'devices': {'num_gpus': 1}}
2025-08-07 11:02:14,644 INFO    MainThread:8237 [wandb_watch.py:_watch():70] Watching
