_wandb:
    value:
        cli_version: 0.21.0
        e:
            i9wgim7pgl7hzfkt1pqdnuliicocqx2d:
                args:
                    - --config_file
                    - /home/visier/safety-critical/CTG/cld_config.json
                    - --source_train
                    - nusc_mini-mini_train
                    - --source_valid
                    - nusc_mini-mini_val
                    - --nusc_trainval_dir
                    - /home/visier/nuscenes
                    - --nusc_mini_dir
                    - /home/visier/nuscenes
                    - --rebuild_cache
                    - "false"
                    - --remove_exp_dir
                codePath: CTG/scripts/cld_training.py
                codePathLocal: CTG/scripts/cld_training.py
                cpu_count: 12
                cpu_count_logical: 24
                cudaVersion: "12.8"
                disk:
                    /:
                        total: "200449576960"
                        used: "24964001792"
                email: yx3006@hw.ac.uk
                executable: /home/visier/miniconda3/envs/sc/bin/python
                gpu: NVIDIA GeForce RTX 4090
                gpu_count: 1
                gpu_nvidia:
                    - architecture: Ada
                      cudaCores: 16384
                      memoryTotal: "25757220864"
                      name: NVIDIA GeForce RTX 4090
                      uuid: GPU-d7b626fe-d798-9201-8e23-448008853ff0
                host: visier
                memory:
                    total: "63565189120"
                os: Linux-6.11.0-29-generic-x86_64-with-glibc2.40
                program: /home/visier/safety-critical/CTG/scripts/cld_training.py
                python: CPython 3.9.23
                root: .
                startedAt: "2025-08-07T09:57:10.258853Z"
                writerId: i9wgim7pgl7hzfkt1pqdnuliicocqx2d
        m:
            - "1": trainer/global_step
              "6":
                - 3
              "7": []
            - "2": '*'
              "5": 1
              "6":
                - 1
              "7": []
        python_version: 3.9.23
        t:
            "1":
                - 1
                - 5
                - 9
                - 41
                - 53
                - 79
                - 103
            "2":
                - 1
                - 5
                - 9
                - 41
                - 53
                - 79
                - 103
            "3":
                - 1
                - 7
                - 13
                - 66
            "4": 3.9.23
            "5": 0.21.0
            "12": 0.21.0
            "13": linux-x86_64
algo:
    value:
        attn_dilations:
            - 1
            - 2
            - 4
        attn_hidden_dim: 64
        attn_n_heads: 4
        cond_feat_dim: 128
        ddim_steps: 20
        dynamics:
            acce_bound:
                - -3
                - 3
            ddh_bound:
                - -6.283185307179586
                - 6.283185307179586
            max_speed: 40
            max_steer: 0.5
            max_yawvel: 2.5
            type: Unicycle
        future_num_frames: 52
        grid_map_traj_dim: 32
        history_feature_dim: 64
        history_num_frames: 30
        horizon: 52
        map_encoder_model_arch: resnet18
        map_feature_dim: 128
        map_grid_feature_dim: 32
        mix_gauss: 5
        n_diffusion_steps: 100
        name: diffuser_ppo
        norm_info:
            agent_hist:
                - - -1.198923
                  - 0.000128
                  - 0.953161
                  - 4.698113
                  - 2.051664
                - - 3.180241
                  - 0.159182
                  - 2.129779
                  - 2.116855
                  - 0.388149
            diffuser:
                - - 2.135494
                  - 0.003704
                  - 0.970226
                  - 0.000573
                  - -0.002965
                  - 0.000309
                - - 5.5444
                  - 0.524067
                  - 2.206522
                  - 0.049049
                  - 0.729327
                  - 0.023765
            neighbor_hist:
                - - -0.237441
                  - 1.118636
                  - 0.489575
                  - 0.868664
                  - 0.222984
                - - 7.587311
                  - 7.444489
                  - 1.680952
                  - 2.578202
                  - 0.832563
        optim_params:
            learning_rate:
                initial: 0.0002
                weight_decay: 0.0001
        scene_agent_max_neighbor_dist: 30
        state_in_dim: 4
        state_out_feat_dim: 64
        step_time: 0.1
        time_emb_dim: 32
devices:
    value:
        num_gpus: 1
env:
    value:
        data_generation_params:
            incl_robot_future: true
            other_agents_num: null
            trajdata_centric: agent
            trajdata_incl_map: true
            trajdata_max_agents_distance: 50
            trajdata_only_types:
                - vehicle
            trajdata_predict_types:
                - vehicle
            trajdata_scene_desc_contains: null
            trajdata_standardize_data: true
        name: trajdata
        rasterizer:
            drivable_layers: null
            ego_center:
                - -0.5
                - 0
            include_hist: true
            no_map_fill_value: -1
            num_sem_layers: 3
            pixel_size: 1
            raster_size: 224
            rgb_idx_groups:
                - - 0
                - - 1
                - - 2
eval:
    value:
        adjustment:
            initial_num_neighbors: 4
            num_frame_per_new_agent: 20
            random_init_plan: false
            remove_existing_neighbors: false
        agent_eval_class: null
        ckpt:
            cvae_metric:
                ckpt_dir: null
                ckpt_key: null
                ngc_job_id: null
            occupancy_metric:
                ckpt_dir: null
                ckpt_key: null
                ngc_job_id: null
            planner:
                ckpt_dir: null
                ckpt_key: null
                ngc_job_id: null
            policy:
                ckpt_dir: null
                ckpt_key: null
                ngc_job_id: null
            predictor:
                ckpt_dir: null
                ckpt_key: null
                ngc_job_id: null
        ckpt_root_dir: checkpoints/
        cvae:
            rolling: true
            rolling_horizon:
                - 5
                - 10
                - 20
        dataset_path: null
        denoising_params:
            perturb_output_trajectory: false
            stride: 1
        ego_only: false
        env: nusc
        eval_class: ""
        experience_hdf5_path: null
        filtration: false
        goal_conditional: false
        guidance_optimization_params:
            grad_steps: 1
            lr: 0.3
            optimizer: adam
            perturb_th: null
        l5kit:
            eval_scenes:
                - 9058
                - 5232
                - 14153
                - 8173
                - 10314
                - 7027
                - 9812
                - 1090
                - 9453
                - 978
                - 10263
                - 874
                - 5563
                - 9613
                - 261
                - 2826
                - 2175
                - 9977
                - 6423
                - 1069
                - 1836
                - 8198
                - 5034
                - 6016
                - 2525
                - 927
                - 3634
                - 11806
                - 4911
                - 6192
                - 11641
                - 461
                - 142
                - 15493
                - 4919
                - 8494
                - 14572
                - 2402
                - 308
                - 1952
                - 13287
                - 15614
                - 6529
                - 12
                - 11543
                - 4558
                - 489
                - 6876
                - 15279
                - 6095
                - 5877
                - 8928
                - 10599
                - 16150
                - 11296
                - 9382
                - 13352
                - 1794
                - 16122
                - 12429
                - 15321
                - 8614
                - 12447
                - 4502
                - 13235
                - 2919
                - 15893
                - 12960
                - 7043
                - 9278
                - 952
                - 4699
                - 768
                - 13146
                - 8827
                - 16212
                - 10777
                - 15885
                - 11319
                - 9417
                - 14092
                - 14873
                - 6740
                - 11847
                - 15331
                - 15639
                - 11361
                - 14784
                - 13448
                - 10124
                - 4872
                - 3567
                - 5543
                - 2214
                - 7624
                - 10193
                - 7297
                - 1308
                - 3951
                - 14001
            n_step_action: 5
            num_simulation_steps: 200
            skimp_rollout: false
            skip_first_n: 1
        metrics:
            compute_analytical_metrics: true
            compute_learned_metrics: false
        name: null
        num_episode_repeats: 1
        num_filtration_samples: 5
        num_scenes_per_batch: 1
        num_scenes_to_evaluate: 1
        nusc:
            eval_scenes:
                - 30
            future_sec: 5.2
            history_sec: 3
            n_step_action: 5
            num_simulation_steps: 200
            skip_first_n: 0
            trajdata_data_dirs:
                nusc_trainval: ../behavior-generation-dataset/nuscenes
            trajdata_source_test:
                - nusc_trainval-val
        occupancy:
            rolling: true
            rolling_horizon:
                - 5
                - 10
                - 20
        perturb:
            OU:
                scale:
                    - 1
                    - 1
                    - 0.2
                sigma:
                    - 0
                    - 0.1
                    - 0.2
                    - 0.5
                    - 1
                    - 2
                    - 4
                theta: 0.8
            enabled: false
        perturb_opt_params:
            grad_steps: 30
            optimizer: adam
            optimizer_params:
                lr: 0.001
            perturb_th: 100
        perturb_output_trajectory: false
        policy:
            class_free_guide_w: 0
            cost_weights:
                collision_weight: 10
                lane_weight: 1
                likelihood_weight: 0
                progress_weight: 0
            diversification_clearance: null
            guide_as_filter_only: false
            guide_clean: video_diff
            mask_drivable: true
            num_action_samples: 2
            num_plan_samples: 50
            pos_to_yaw: true
            sample: false
            use_ema: false
            yaw_correction_speed: 1
        results_dir: results/
        rolling_perturb:
            OU:
                scale:
                    - 1
                    - 1
                    - 0.2
                sigma: 0.5
                theta: 0.8
            enabled: false
        seed: 0
        seed_each_episode: null
        start_frame_index_each_episode: null
        trajdata:
            trajdata_cache_location: ~/.unified_data_cache
            trajdata_rebuild_cache: false
name:
    value: test
registered_name:
    value: safety_critical
root_dir:
    value: safety_critical_trained_models/
seed:
    value: 42
train:
    value:
        datamodule_class: CLDDataModule
        logging:
            flush_every_n_steps: 100
            log_every_n_steps: 10
            log_tb: false
            log_wandb: true
            terminal_output_to_txt: true
            wandb_project_name: SC_GMM_Diffuser
        on_ngc: false
        parallel_strategy: null
        rebuild_cache: "false"
        rollout:
            enabled: false
            every_n_steps: 10000
            save_video: true
            warm_start_n_steps: 0
        save:
            best_k: 1
            enabled: true
            every_n_steps: 10
            save_best_rollout: false
            save_best_validation: true
        training:
            batch_size: 64
            num_data_workers: 16
            num_steps: 200
        training_vec_map_params:
            S_point: 80
            S_seg: 15
            ahead_threshold: -40
            dist_weight: 1
            heading_weight: 0.1
            map_max_dist: 80
            max_heading_error: 0.7853981633974483
        trajdata_cache_location: /home/visier/cld_cache
        trajdata_data_dirs:
            nusc_mini: /home/visier/nuscenes
            nusc_test: /home/visier/nuscenes
            nusc_trainval: /home/visier/nuscenes
        trajdata_rebuild_cache: false
        trajdata_source_train:
            - nusc_mini-mini_train
        trajdata_source_valid:
            - nusc_mini-mini_val
        validation:
            batch_size: 32
            enabled: true
            every_n_steps: 500
            num_data_workers: 16
            num_steps_per_epoch: 5
