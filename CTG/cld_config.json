{
    "registered_name": "safety_critical",
    "train": {
      "logging": {
        "terminal_output_to_txt": true,
        "log_wandb": true,
        "wandb_project_name": "SC_GMM_Diffuser",
        "log_every_n_steps": 10,
        "flush_every_n_steps": 100
      },
      "save": {
        "enabled": true,
        "every_n_steps": 5000,
        "best_k": 1,
        "save_best_rollout": false,
        "save_best_validation": true
      },
      "rollout": {
        "save_video": true,
        "enabled": false,
        "every_n_steps": 10000,
        "warm_start_n_steps": 0
      },
      "training": {
        "batch_size": 64,
        "num_steps": 150000,
        "num_data_workers": 16
      },
      "validation": {
        "enabled": true,
        "batch_size": 32,
        "num_data_workers": 16,
        "every_n_steps": 2000,
        "num_steps_per_epoch": 5
      },

      "datamodule_class": "CLDDataModule",
      
      "trajdata_source_train": ["nusc_trainval-train","nusc_trainval-train_val"],
      "trajdata_source_valid": ["nusc_trainval-val"],
      
      "rebuild_cache": true

    },







    "env": {
      "name": "trajdata",
      "data_generation_params": {
        "trajdata_centric": "agent",
        "trajdata_only_types": ["vehicle"],
        "trajdata_predict_types": ["vehicle"],
        "trajdata_incl_map": true,
        "trajdata_max_agents_distance": 50,
        "trajdata_standardize_data": true,
        "other_agents_num": null,
        "incl_robot_future": true
      },
      "rasterizer": {
        "raster_size": 224,
        "pixel_size": 1.0,
        "ego_center": [-0.5,0.0],
        "no_map_fill_value": -1.0,
        "num_sem_layers": 3
    
      }
    },






    
    "algo": {
      "future_num_frames": 52,
     
      "step_time": 0.1,
      "map_encoder_model_arch": "resnet18",
      "map_feature_dim": 128,
      "map_grid_feature_dim": 32,

      "history_num_frames": 30,
      "history_feature_dim": 64,

      "state_in_dim": 4,
      "state_out_feat_dim": 64,

      "cond_feat_dim": 128,
      "time_emb_dim": 32,

      "attn_hidden_dim": 64,
      "attn_dilations": [1,2,4],
      "attn_n_heads": 4,
      "grid_map_traj_dim": 32,
      "mix_gauss": 5,

      "name": "diffuser_ppo",  
      "scene_agent_max_neighbor_dist": 30,
      "horizon": 52,
      "n_diffusion_steps": 100,
      "ddim_steps": 20,
      "disable_control_on_stationary": "any_speed",
      "moving_speed_th": 2,

      "dynamics": {
        "type": "Unicycle",
        "max_steer": 0.3,
        "max_yawvel": 2.0,
        "acce_bound": [-3,3],
        "ddh_bound": [-6.283185307179586,6.283185307179586],
        "max_speed": 40.0
      },

      "optim_params": {
          "learning_rate": {
            "initial": 0.0002,
            "weight_decay": 1e-4
          } 
        }
   
   

    },
    
    "name": "delete",
    "root_dir": "safety_critical_trained_models/",
    "seed": 42

  }
  