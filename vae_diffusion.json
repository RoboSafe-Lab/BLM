{
    "registered_name": "vae_diffusion",
    "train": {
      "logging": {
        "terminal_output_to_txt": true,
        "log_wandb": true,
        "wandb_project_name": "VAE",
        "log_every_n_steps": 10,
        "flush_every_n_steps": 100
      },
      "save": {
        "enabled": true,
        "every_n_steps": 5000,
        "best_k": 1,
        "save_best_rollout": false,
        "save_best_validation": true
      },
      "rollout": {
        "save_video": true,
        "enabled": false,
        "every_n_steps": 10000,
        "warm_start_n_steps": 0
      },
      "training": {
        "batch_size": 128,
        "num_steps": 300000,
        "num_data_workers": 16
      },
      "validation": {
        "enabled": true,
        "batch_size": 64,
        "num_data_workers": 16,
        "every_n_steps": 2000,
        "num_steps_per_epoch": 50
      },

      "datamodule_class": "CLDDataModule",
      
      "trajdata_source_train": ["nusc_trainval-train","nusc_trainval-train_val"],
      "trajdata_source_valid": ["nusc_trainval-val"],
      
      "rebuild_cache": false

    },







    "env": {
      "name": "trajdata",
      "data_generation_params": {
        "trajdata_centric": "agent",
        "trajdata_only_types": ["vehicle"],
        "trajdata_predict_types": ["vehicle"],
        "trajdata_incl_map": true,
        "trajdata_max_agents_distance": 50,
        "trajdata_standardize_data": true,
        "other_agents_num": null,
        "incl_robot_future": true
      },
      "rasterizer": {
        "raster_size": 224,
        "pixel_size": 1.0,
        "ego_center": [-0.5,0.0],
        "no_map_fill_value": -1.0,
        "num_sem_layers": 3
    
      }
    },






    
    "algo": {
      "future_num_frames": 52,
      "history_num_frames": 30,
      "dt": 0.1,

      "map_encoder_model_arch": "resnet18",
      "global_feature_dim": 128,
      "grid_feature_dim": 32,

      "center_history_out_dim": 128,

      "norm_info_center":
      [
        [-1.1693, 0.0069, 0, 0.0001, 0.0146, 0.0003, 3.6896],
        [7.5614,  1.0793, 1, 0.1002, 0.6766, 0.0533, 2.2774]
      ],
      "norm_info_neighbor":[
        [1.7597,  1.6100, 3.9131, -0.0762, 0.0691, 0.0007, 3.6896],
        [25.8932, 19.2935, 3.8771, 2.1291, 1.1453, 0.0894, 2.2774]
      ],
      
      "history_feature_dim": 64,
      "state_encoder_out_dim": 64,
      "neighbor_history_out_dim":128,

      "context_encoder_hidden_dim": 128,
      "context_encoder_out_dim": 128,

      "time_emb_dim": 32,
      "diffusion_hidden_dim":64,
      "dilations": [1,2,4,8],
      "num_heads":4,

    
      "n_diffusion_steps": 100,

      "Dynamics":{
        "max_steer": 0.25,  
        "max_yawvel": 2.0,
        "acce_bound": [-3,3],
        "vbound": [0,8]
      },
      "ddim_steps": 20,



      "name": "latent_diffusion",  
   
    
      "disable_control_on_stationary": "any_speed",
      "moving_speed_th": 2,
      "ppo_actor_hidden":64,
      "optim_params": {
          "learning_rate": {
            "initial": 0.0002,
            "weight_decay": 1e-4
          } 
        },

       "vae":{
        "vae_input_dim": 2,
        "vae_enc_channels": 64,
        "vae_latent_dim": 8,
        "vae_sample_stride": 4,
        "vae_lowpass_kernel": 7,
        "vae_dec_channels": 64,
        "vae_output_dim": 2,
        "beta_max":10,
        "beta_warmup_steps": 10000

        },
        "latent_diffusion":{
           
        },
        "vae_ckpt_path": "safety_critical_trained_models/vae/checkpoints/iter5000.ckpt"
    

      },
    
    "name": "vae",
    "root_dir": "safety_critical_trained_models/",
    "seed": 42

  }
  